{"ast":null,"code":"var _jsxFileName = \"/home/darrrks/WebstormProjects/test_proj/lol_front/src/components/Simulation/FacilitatorTable.jsx\";\nimport React, { useMemo } from 'react';\nimport { filter as _filter } from 'lodash';\nimport { view } from '@risingstack/react-easy-state';\nimport SystemRelatedActions from './SystemRelatedActions';\nimport BudgetItems from './BudgetItems';\nimport ResolvedInjections from './Injections/ResolvedInjections';\nimport InjectsAndResponses from './Injections/InjectsAndResponses';\nimport { SimulationTabs } from '../../constants';\nimport { gameStore } from '../GameStore';\nimport { useStaticData } from '../StaticDataProvider';\nimport useTimeTaken from '../../hooks/useTimeTaken';\nconst FacilitatorTable = view(({\n  activeTab\n}) => {\n  const location = useMemo(() => {\n    if (activeTab === SimulationTabs.CAMPAIGN_HQ) {\n      return 'hq';\n    }\n\n    return 'local';\n  }, [activeTab]);\n  const {\n    injections: gameInjections\n  } = gameStore;\n  const {\n    injections\n  } = useStaticData();\n  const timeTaken = useTimeTaken();\n  const {\n    injectionsToResponse,\n    resolvedInjections\n  } = useMemo(() => {\n    let injectionToDeliverFound = false;\n    return _filter(injections, ({\n      location: injectionLocation\n    }) => injectionLocation === location || injectionLocation === null).reduce((acc, injection) => {\n      const gameInjection = gameInjections[injection.id];\n      const isBackground = injection.type === 'Background';\n      const {\n        delivered,\n        prevented,\n        response_made_at: responseMadeAt\n      } = gameInjection;\n      const upcoming = timeTaken < injection.trigger_time;\n      const resolved = timeTaken > injection.trigger_time && (responseMadeAt || prevented || isBackground && delivered);\n      const canMakeResponse = !responseMadeAt && delivered && !isBackground;\n      const canDeliver = !upcoming && !delivered && !injectionToDeliverFound && !prevented;\n\n      if (canDeliver) {\n        injectionToDeliverFound = true;\n      }\n\n      const injectionWithParams = {\n        injection,\n        upcoming: timeTaken < injection.trigger_time,\n        resolved,\n        canDeliver,\n        canMakeResponse,\n        delivered,\n        gameInjection,\n        prevented,\n        isBackground,\n        isDanger: !canDeliver && !canMakeResponse && injection.trigger_time - timeTaken < 180000\n      };\n\n      if (resolved) {\n        acc.resolvedInjections.push(injectionWithParams);\n      } else {\n        acc.injectionsToResponse.push(injectionWithParams);\n      }\n\n      return acc;\n    }, {\n      injectionsToResponse: [],\n      resolvedInjections: []\n    });\n  }, [injections, location, gameInjections, timeTaken]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(InjectsAndResponses, {\n    className: \"my-5\",\n    injectionsToResponse: injectionsToResponse,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(BudgetItems, {\n    className: \"my-5\",\n    location: location,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(SystemRelatedActions, {\n    className: \"my-5 pb-5\",\n    location: location,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(ResolvedInjections, {\n    className: \"my-5\",\n    resolvedInjections: resolvedInjections,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }));\n});\nexport default FacilitatorTable;","map":{"version":3,"sources":["/home/darrrks/WebstormProjects/test_proj/lol_front/src/components/Simulation/FacilitatorTable.jsx"],"names":["React","useMemo","filter","_filter","view","SystemRelatedActions","BudgetItems","ResolvedInjections","InjectsAndResponses","SimulationTabs","gameStore","useStaticData","useTimeTaken","FacilitatorTable","activeTab","location","CAMPAIGN_HQ","injections","gameInjections","timeTaken","injectionsToResponse","resolvedInjections","injectionToDeliverFound","injectionLocation","reduce","acc","injection","gameInjection","id","isBackground","type","delivered","prevented","response_made_at","responseMadeAt","upcoming","trigger_time","resolved","canMakeResponse","canDeliver","injectionWithParams","isDanger","push"],"mappings":"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","sourcesContent":["import React, { useMemo } from 'react';\nimport { filter as _filter } from 'lodash';\nimport { view } from '@risingstack/react-easy-state';\n\nimport SystemRelatedActions from './SystemRelatedActions';\nimport BudgetItems from './BudgetItems';\nimport ResolvedInjections from './Injections/ResolvedInjections';\nimport InjectsAndResponses from './Injections/InjectsAndResponses';\nimport { SimulationTabs } from '../../constants';\nimport { gameStore } from '../GameStore';\nimport { useStaticData } from '../StaticDataProvider';\nimport useTimeTaken from '../../hooks/useTimeTaken';\n\nconst FacilitatorTable = view(({ activeTab }) => {\n  const location = useMemo(() => {\n    if (activeTab === SimulationTabs.CAMPAIGN_HQ) {\n      return 'hq';\n    }\n    return 'local';\n  }, [activeTab]);\n\n  const { injections: gameInjections } = gameStore;\n  const { injections } = useStaticData();\n  const timeTaken = useTimeTaken();\n\n  const { injectionsToResponse, resolvedInjections } = useMemo(() => {\n    let injectionToDeliverFound = false;\n    return _filter(\n      injections,\n      ({ location: injectionLocation }) =>\n        injectionLocation === location || injectionLocation === null,\n    ).reduce(\n      (acc, injection) => {\n        const gameInjection = gameInjections[injection.id];\n        const isBackground = injection.type === 'Background';\n        const {\n          delivered,\n          prevented,\n          response_made_at: responseMadeAt,\n        } = gameInjection;\n        const upcoming = timeTaken < injection.trigger_time;\n        const resolved =\n          timeTaken > injection.trigger_time &&\n          (responseMadeAt ||\n            prevented ||\n            (isBackground && delivered));\n        const canMakeResponse =\n          !responseMadeAt && delivered && !isBackground;\n        const canDeliver =\n          !upcoming &&\n          !delivered &&\n          !injectionToDeliverFound &&\n          !prevented;\n        if (canDeliver) {\n          injectionToDeliverFound = true;\n        }\n        const injectionWithParams = {\n          injection,\n          upcoming: timeTaken < injection.trigger_time,\n          resolved,\n          canDeliver,\n          canMakeResponse,\n          delivered,\n          gameInjection,\n          prevented,\n          isBackground,\n          isDanger:\n            !canDeliver &&\n            !canMakeResponse &&\n            injection.trigger_time - timeTaken < 180000,\n        };\n        if (resolved) {\n          acc.resolvedInjections.push(injectionWithParams);\n        } else {\n          acc.injectionsToResponse.push(injectionWithParams);\n        }\n        return acc;\n      },\n      { injectionsToResponse: [], resolvedInjections: [] },\n    );\n  }, [injections, location, gameInjections, timeTaken]);\n\n  return (\n    <>\n      <InjectsAndResponses\n        className=\"my-5\"\n        injectionsToResponse={injectionsToResponse}\n      />\n      <BudgetItems className=\"my-5\" location={location} />\n      <SystemRelatedActions\n        className=\"my-5 pb-5\"\n        location={location}\n      />\n      <ResolvedInjections\n        className=\"my-5\"\n        resolvedInjections={resolvedInjections}\n      />\n    </>\n  );\n});\n\nexport default FacilitatorTable;\n"]},"metadata":{},"sourceType":"module"}